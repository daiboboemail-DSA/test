# 案例库管理系统 - 管理后台需求文档

## 📋 功能模块总览

### 1. 案例管理模块

#### 1.1 案例列表
**功能：**
- 显示所有案例的列表
- 支持分页显示
- 支持搜索（按标题、标签、描述）
- 支持筛选（按标签、状态、日期）
- 支持排序（按创建时间、更新时间、标题）

**界面元素：**
- 搜索框
- 筛选器（标签下拉、状态选择、日期范围）
- 排序选择器
- 案例卡片/列表
- 分页控件
- 批量操作按钮

**操作：**
- 点击案例 → 查看详情/编辑
- 勾选案例 → 批量操作（删除、修改状态、修改标签）
- 快速操作按钮（编辑、删除、复制）

#### 1.2 案例详情/编辑
**功能：**
- 查看案例完整信息
- 编辑案例信息
- 上传/替换图片和视频
- 管理标签

**表单字段：**
- 标题（必填）
- 描述（多行文本）
- 标签（多选，支持创建新标签）
- Before 图片（支持上传/替换）
- After 图片（支持上传/替换）
- 视频（可选，支持上传/替换/删除）
- 状态（发布/草稿/隐藏）
- 创建时间（自动）
- 更新时间（自动）

**操作：**
- 保存（保存为草稿）
- 发布（保存并发布）
- 取消（放弃修改）
- 删除

#### 1.3 案例创建
**功能：**
- 创建新案例
- 与编辑界面相同，但初始为空

---

### 2. 标签管理模块

#### 2.1 标签列表
**功能：**
- 显示所有标签
- 显示标签使用次数
- 标签颜色标识

**界面元素：**
- 标签卡片（显示名称、颜色、使用次数）
- 创建标签按钮
- 搜索框

**操作：**
- 点击标签 → 编辑
- 删除标签（需确认，如果有关联案例需提示）

#### 2.2 标签创建/编辑
**功能：**
- 创建新标签
- 编辑现有标签

**表单字段：**
- 标签名称（必填，唯一）
- 标签颜色（颜色选择器）
- 标签描述（可选）

**操作：**
- 保存
- 取消

---

### 3. 媒体管理模块

#### 3.1 媒体库
**功能：**
- 浏览所有上传的媒体文件
- 支持图片和视频分类显示
- 支持搜索和筛选

**界面元素：**
- 媒体网格视图
- 筛选器（类型、日期、标签）
- 上传按钮
- 批量选择

**操作：**
- 点击媒体 → 查看大图/播放视频
- 选择媒体 → 批量删除
- 上传新媒体

#### 3.2 媒体上传
**功能：**
- 上传图片（支持多图）
- 上传视频
- 显示上传进度
- 自动压缩/优化

**支持格式：**
- 图片：JPG, PNG, WebP
- 视频：MP4, WebM

---

### 4. 数据统计模块

#### 4.1 概览统计
**功能：**
- 案例总数
- 已发布案例数
- 草稿数
- 标签总数
- 媒体文件总数

#### 4.2 图表展示
**功能：**
- 按标签分类的案例数量（饼图/柱状图）
- 案例上传趋势（折线图）
- 媒体文件类型分布（饼图）

---

## 🗄️ 数据库设计

### 需要扩展的表结构

#### 1. 标签表（tags）
```sql
CREATE TABLE IF NOT EXISTS tags (
  id BIGSERIAL PRIMARY KEY,
  name VARCHAR(100) UNIQUE NOT NULL,
  color VARCHAR(7) DEFAULT '#3B82F6', -- 十六进制颜色
  description TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

#### 2. 案例标签关联表（case_tags）
```sql
CREATE TABLE IF NOT EXISTS case_tags (
  case_id BIGINT REFERENCES cases(id) ON DELETE CASCADE,
  tag_id BIGINT REFERENCES tags(id) ON DELETE CASCADE,
  PRIMARY KEY (case_id, tag_id)
);
```

#### 3. 扩展案例表
```sql
-- 添加新字段到 cases 表
ALTER TABLE cases ADD COLUMN IF NOT EXISTS video_url TEXT;
ALTER TABLE cases ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'published'; -- published, draft, hidden
ALTER TABLE cases ADD COLUMN IF NOT EXISTS sort_order INTEGER DEFAULT 0;
```

---

## 🎨 界面设计要求

### 设计风格
- 与前端展示页面保持一致的设计语言
- 使用相同的颜色方案和字体
- 保持简洁、专业的风格

### 布局结构
```
┌─────────────────────────────────────┐
│  顶部导航栏（Logo + 用户信息）        │
├──────────┬──────────────────────────┤
│          │                           │
│  侧边栏  │      主内容区              │
│  导航    │      （动态内容）          │
│          │                           │
│  - 案例  │                           │
│  - 标签  │                           │
│  - 媒体  │                           │
│  - 统计  │                           │
│          │                           │
└──────────┴──────────────────────────┘
```

### 响应式设计
- 桌面端：侧边栏 + 主内容区
- 平板端：可折叠侧边栏
- 移动端：底部导航栏

---

## 🔐 权限管理（可选）

### 用户角色
- **管理员**：所有权限
- **编辑**：可以创建、编辑、删除案例
- **查看者**：只能查看，不能修改

### 权限控制
- 基于 Supabase Auth
- 使用 Row Level Security (RLS)
- 在管理后台中根据角色显示/隐藏功能

---

## 📝 实现优先级

### Phase 1: 核心功能（必须）
1. ✅ 案例列表和搜索
2. ✅ 案例创建/编辑/删除
3. ✅ 基础标签管理
4. ✅ 图片上传

### Phase 2: 增强功能（重要）
1. ⏳ 视频上传和管理
2. ⏳ 批量操作
3. ⏳ 标签关联管理
4. ⏳ 案例状态管理

### Phase 3: 高级功能（可选）
1. ⏳ 数据统计和图表
2. ⏳ 媒体库管理
3. ⏳ 权限管理
4. ⏳ 导入/导出功能

---

## 🚀 技术实现建议

### 前端技术栈
- React + Vite（与现有项目一致）
- Tailwind CSS（与现有项目一致）
- React Router（路由管理）
- React Query / SWR（数据获取和缓存）
- React Hook Form（表单管理）
- Recharts（图表展示）

### 后端/数据库
- Supabase（数据库 + 存储 + Auth）
- Supabase Storage（媒体文件存储）

### 文件结构建议
```
src/
├── admin/              # 管理后台
│   ├── components/     # 管理后台组件
│   ├── pages/          # 管理后台页面
│   ├── hooks/          # 管理后台 Hooks
│   └── services/       # 管理后台服务
├── App.jsx             # 前端展示页面
└── services/            # 共享服务
```

